
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE COLOSSEUM - ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø´ÙØ±Ø§Øª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            overflow-x: hidden;
            background: #1a1a1a;
            color: #fff;
        }

        body.dark {
            background: linear-gradient(135deg, #0a0e27, #1a1a3e);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
        }

        .header h1 {
            font-size: 3em;
            background: linear-gradient(135deg, #d4af37, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 3px;
        }

        .header p {
            font-size: 1.2em;
            color: #d4af37;
            margin-top: 10px;
            font-style: italic;
        }

        .screen {
            display: none;
            animation: fadeIn 0.5s;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 70vh;
        }

        .login-box {
            background: rgba(212, 175, 55, 0.1);
            border: 3px solid #d4af37;
            padding: 50px;
            border-radius: 10px;
            width: 100%;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.3);
        }

        .login-box h2 {
            color: #d4af37;
            margin-bottom: 30px;
            font-size: 2.5em;
            letter-spacing: 2px;
        }

        .login-box input {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            border: 2px solid #d4af37;
            border-radius: 5px;
            font-size: 1.1em;
            background: rgba(255, 255, 255, 0.05);
            color: inherit;
            text-align: center;
        }

        .login-box button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #d4af37, #ffd700);
            color: #000;
            border: none;
            border-radius: 5px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        .login-box button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.8);
        }

        .admin-link {
            color: #d4af37;
            cursor: pointer;
            font-size: 0.9em;
            text-decoration: underline;
            margin-top: 20px;
        }

        .admin-link:hover {
            color: #ffd700;
        }

        .teams-title {
            text-align: center;
            font-size: 2.5em;
            color: #d4af37;
            margin-bottom: 40px;
            letter-spacing: 2px;
        }

        .teams-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .team-card {
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid #d4af37;
            padding: 25px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
        }

        .team-card:hover:not(.disabled) {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.5);
            border-color: #ffd700;
        }

        .team-card.selected {
            background: rgba(212, 175, 55, 0.3);
            border-color: #ffd700;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.8);
        }

        .team-card.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            background: rgba(100, 100, 100, 0.2);
            border-color: #888;
        }

        .team-card h3 {
            color: #d4af37;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .team-status {
            font-size: 0.9em;
            color: #d4af37;
            margin-top: 10px;
        }

        .team-btn {
            background: #d4af37;
            color: #000;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }

        .team-btn:hover {
            background: #ffd700;
            transform: scale(1.05);
        }

        .start-btn {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #d4af37, #ffd700);
            color: #000;
            border: none;
            border-radius: 5px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 30px;
            display: none;
            transition: all 0.3s;
        }

        .start-btn.show {
            display: block;
        }

        .start-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.8);
        }

        .code-screen {
            background: linear-gradient(135deg, #0a0e27, #1a1a3e);
            min-height: 100vh;
        }

        .code-container {
            background: rgba(0, 0, 0, 0.8);
            border: 3px solid #d4af37;
            padding: 50px;
            border-radius: 10px;
            max-width: 600px;
            margin: 50px auto;
            text-align: center;
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.5);
        }

        .code-container h2 {
            color: #d4af37;
            font-size: 2em;
            margin-bottom: 30px;
            letter-spacing: 2px;
        }

        .team-info {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #ffd700;
        }

        .timer-display {
            background: rgba(212, 175, 55, 0.2);
            border: 2px solid #d4af37;
            padding: 15px;
            border-radius: 8px;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #d4af37;
        }

        .code-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #d4af37;
            border-radius: 5px;
            font-size: 1.3em;
            background: rgba(255, 255, 255, 0.05);
            color: #d4af37;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
        }

        .code-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #d4af37, #ffd700);
            color: #000;
            border: none;
            border-radius: 5px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .code-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.8);
        }

        .message {
            margin-top: 20px;
            font-size: 1.1em;
            font-weight: bold;
            min-height: 30px;
        }

        .message.success {
            color: #4CAF50;
        }

        .message.error {
            color: #ff6b6b;
        }

        .images-screen {
            background: linear-gradient(135deg, #0a0e27, #1a1a3e);
            min-height: 100vh;
            padding-top: 30px;
        }

        .images-container {
            background: rgba(0, 0, 0, 0.7);
            border: 3px solid #d4af37;
            padding: 40px;
            border-radius: 10px;
            max-width: 1000px;
            margin: 30px auto;
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.5);
        }

        .images-title {
            color: #d4af37;
            font-size: 2em;
            text-align: center;
            margin-bottom: 30px;
            letter-spacing: 2px;
        }

        .images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .image-box {
            width: 100%;
            height: 250px;
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid #d4af37;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
        }

        .image-box:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.5);
        }

        .image-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .download-section {
            text-align: center;
            margin-top: 30px;
        }

        .download-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px;
        }

        .download-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.6);
        }

        .back-btn {
            background: #d4af37;
            color: #000;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px;
            font-weight: bold;
        }

        .back-btn:hover {
            background: #ffd700;
            transform: scale(1.05);
        }

        .admin-container {
            background: rgba(212, 175, 55, 0.1);
            border: 3px solid #d4af37;
            padding: 40px;
            border-radius: 10px;
            max-width: 600px;
            margin: 50px auto;
            text-align: center;
        }

        .admin-container h2 {
            color: #d4af37;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .admin-btn {
            width: 100%;
            padding: 15px;
            background: #d4af37;
            color: #000;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            cursor: pointer;
            margin: 10px 0;
            font-weight: bold;
            transition: all 0.3s;
        }

        .admin-btn:hover {
            background: #ffd700;
            transform: scale(1.05);
        }

        .admin-btn.danger {
            background: #ff6b6b;
            color: white;
        }

        .admin-btn.danger:hover {
            background: #ff5252;
        }

        .stats-table {
            width: 100%;
            color: #d4af37;
            margin-top: 20px;
            border-collapse: collapse;
        }

        .stats-table th,
        .stats-table td {
            padding: 10px;
            border-bottom: 1px solid #666;
        }

        .stats-table th {
            border-bottom: 2px solid #d4af37;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .images-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .teams-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="dark">
    <div class="header">
        <h1>ğŸ” THE COLOSSEUM</h1>
        <p>ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø´ÙØ±Ø§Øª - ÙÙŠ Ø§Ù„Ø£Ù„ØºØ§Ø²</p>
    </div>

    <div class="container">
        <!-- Login Screen -->
        <div class="screen active" id="loginScreen">
            <div class="login-container">
                <div class="login-box">
                    <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
                    <input type="text" id="userNameInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„" onkeypress="if(event.key==='Enter') goToTeams()">
                    <button onclick="goToTeams()">Ø¯Ø®ÙˆÙ„</button>
                    <div class="admin-link" onclick="showAdminLogin()">ğŸ” Ù‡Ù„ Ø£Ù†Øª Ù…Ø³Ø¤ÙˆÙ„ØŸ</div>
                </div>
            </div>
        </div>

        <!-- Admin Login Screen -->
        <div class="screen" id="adminLoginScreen">
            <div class="login-container">
                <div class="login-box">
                    <h2>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
                    <input type="password" id="adminPassInput" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" onkeypress="if(event.key==='Enter') loginAdmin()">
                    <button onclick="loginAdmin()">Ø¯Ø®ÙˆÙ„</button>
                    <button style="background: #888; margin-top: 10px;" onclick="backToLogin()">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
                </div>
            </div>
        </div>

        <!-- Teams Screen -->
        <div class="screen" id="teamsScreen">
            <h2 class="teams-title">ğŸ‘¥ Ø§Ø®ØªØ± ÙØ±ÙŠÙ‚Ùƒ</h2>
            <div style="text-align: center; color: #d4af37; margin-bottom: 20px; font-size: 1.1em;">
                <div id="timerDisplay" style="background: rgba(212, 175, 55, 0.2); border: 2px solid #d4af37; padding: 15px; border-radius: 8px; font-weight: bold; font-family: 'Courier New', monospace; font-size: 1.5em; display: none;">
                    â±ï¸ <span id="timeDisplay">02:00:00</span>
                </div>
            </div>
            <div class="teams-grid" id="teamsGrid"></div>
            <button class="start-btn" id="startBtn" onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ù‚ÙŠÙ‚</button>
        </div>

        <!-- Code Screen -->
        <div class="screen code-screen" id="codeScreen">
            <div class="code-container">
                <h2>ğŸ”“ Ø­Ù„ Ø§Ù„Ø´ÙØ±Ø©</h2>
                <div class="team-info" id="teamInfoCode"></div>
                <div class="timer-display" id="codeTimer">â±ï¸ 02:00:00</div>
                <input type="text" id="codeInput" class="code-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø´ÙØ±Ø©" onkeypress="if(event.key==='Enter') verifyCode()">
                <button class="code-btn" onclick="verifyCode()">ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´ÙØ±Ø©</button>
                <div class="message" id="codeMessage"></div>
            </div>
        </div>

        <!-- Images Screen -->
        <div class="screen images-screen" id="imagesScreen">
            <div class="images-container">
                <h2 class="images-title">ğŸ“‹ Ù…Ù„ÙØ§Øª Ø§Ù„Ù‚Ø¶ÙŠØ©</h2>
                <div class="images-grid" id="imagesGrid"></div>
                <div class="download-section">
                    <button class="back-btn" onclick="backToTeams()">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
                </div>
            </div>
        </div>

        <!-- Admin Screen -->
        <div class="screen" id="adminScreen">
            <div class="admin-container">
                <h2>ğŸ”§ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
                <button class="admin-btn" onclick="showStats()">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
                <button class="admin-btn danger" onclick="resetGame()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
                <button class="admin-btn" style="background: #888;" onclick="backToLogin()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
            <div id="statsContainer"></div>
        </div>
    </div>

    <script>
        const ADMIN_PASSWORD = 'admin123';
        const CODES = ['POWER', 'WISDOM', 'VALOR', 'PATIENCE', 'PROMTITUDE', 'FAITH', 'HONESTY', 'JUSTICE', 'INTEGRITY'];
        const IMAGES = [
            'https://i.imgur.com/mG1EsgX.jpg',
            'https://i.imgur.com/BgxLUmr.jpg',
            'https://i.imgur.com/shFAoGJ.jpg',
            'https://i.imgur.com/9nQC9ay.jpg',
            'https://i.imgur.com/X9vtn6w.jpg',
            'https://i.imgur.com/23dKeLP.jpg',
            'https://i.imgur.com/rICqT3D.jpg',
            'https://i.imgur.com/3OAJguF.jpg',
            'https://i.imgur.com/B3tnfms.jpg'
        ];

        const teams = Array(9).fill(0).map((_, i) => ({
            id: i + 1,
            number: i + 1,
            members: [],
            leader: null,
            codeIndex: i,
            solved: false,
            attempts: 0
        }));

        let currentUser = null;
        let currentTeam = null;
        let gameStarted = false;
        let timeRemaining = 7200;
        let timerInterval = null;
        let gameData = {
            started: false,
            timeRemaining: 7200,
            teams: []
        };

        function initializeGameData() {
            gameData.teams = teams.map(t => ({
                id: t.id,
                number: t.number,
                members: t.members,
                leader: t.leader,
                codeIndex: t.codeIndex,
                solved: t.solved,
                attempts: t.attempts
            }));
        }

        function loadGameState() {
            const saved = localStorage.getItem('colosseum_game_data');
            if (saved) {
                gameData = JSON.parse(saved);
                gameStarted = gameData.started;
                timeRemaining = gameData.timeRemaining;

                gameData.teams.forEach(teamData => {
                    const team = teams.find(t => t.id === teamData.id);
                    if (team) {
                        team.members = teamData.members;
                        team.leader = teamData.leader;
                        team.solved = teamData.solved;
                        team.attempts = teamData.attempts;
                    }
                });
            } else {
                initializeGameData();
            }
        }

        function saveGameState() {
            gameData.started = gameStarted;
            gameData.timeRemaining = timeRemaining;
            gameData.teams = teams.map(t => ({
                id: t.id,
                number: t.number,
                members: t.members,
                leader: t.leader,
                codeIndex: t.codeIndex,
                solved: t.solved,
                attempts: t.attempts
            }));
            localStorage.setItem('colosseum_game_data', JSON.stringify(gameData));
            // ØªÙ†Ø¨ÙŠÙ‡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ«
            window.dispatchEvent(new Event('gameStateChanged'));
        }

        // Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù…Ù† Ù†ÙˆØ§ÙØ° Ø£Ø®Ø±Ù‰
        window.addEventListener('storage', function(e) {
            if (e.key === 'colosseum_game_data') {
                loadGameState();
                if (document.getElementById('teamsScreen').classList.contains('active')) {
                    renderTeams();
                }
                if (document.getElementById('codeScreen').classList.contains('active')) {
                    updateTimerDisplay();
                }
            }
        });

        // Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù…Ù† Ù†ÙØ³ Ø§Ù„Ù†Ø§ÙØ°Ø©
        window.addEventListener('gameStateChanged', function() {
            if (document.getElementById('teamsScreen').classList.contains('active')) {
                renderTeams();
            }
            if (document.getElementById('codeScreen').classList.contains('active')) {
                updateTimerDisplay();
            }
        });

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function showAdminLogin() {
            showScreen('adminLoginScreen');
            document.getElementById('adminPassInput').value = '';
            document.getElementById('adminPassInput').focus();
        }

        function loginAdmin() {
            const password = document.getElementById('adminPassInput').value;
            if (password === ADMIN_PASSWORD) {
                showScreen('adminScreen');
            } else {
                alert('âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©');
            }
        }

        function goToTeams() {
            const userName = document.getElementById('userNameInput').value.trim();
            if (!userName) {
                alert('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ');
                return;
            }
            currentUser = userName;
            showScreen('teamsScreen');
            renderTeams();
        }

        function renderTeams() {
            const grid = document.getElementById('teamsGrid');
            grid.innerHTML = '';

            teams.forEach(team => {
                const isSelected = currentTeam && currentTeam.id === team.id;
                const isDisabled = team.members.length > 0 && !team.members.includes(currentUser);

                const card = document.createElement('div');
                card.className = `team-card ${isSelected ? 'selected' : ''} ${isDisabled ? 'disabled' : ''}`;

                card.innerHTML = `
                    <h3>Ø§Ù„ÙØ±ÙŠÙ‚ ${team.number}</h3>
                    <div class="team-status">
                        <p>Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: ${team.members.length}/4</p>
                        ${team.members.length > 0 ? `<p style="font-size: 0.9em; margin-top: 8px; color: #ffd700;">ğŸ‘¥ ${team.members.join(', ')}</p>` : '<p style="color: #4CAF50;">âœ… Ù…ØªØ§Ø­</p>'}
                    </div>
                    ${!isDisabled && !team.members.includes(currentUser) ? `<button class="team-btn" onclick="selectTeam(${team.id})">Ø§Ø®ØªØ± Ø§Ù„ÙØ±ÙŠÙ‚</button>` : ''}
                    ${team.members.includes(currentUser) ? `<button class="team-btn" onclick="leaveTeam(${team.id})" style="background: #ff6b6b; color: white;">ØºØ§Ø¯Ø± Ø§Ù„ÙØ±ÙŠÙ‚</button>` : ''}
                `;

                if (!isDisabled) {
                    card.style.cursor = 'pointer';
                }

                grid.appendChild(card);
            });
        }

        function selectTeam(teamId) {
            const team = teams.find(t => t.id === teamId);

            if (team.members.length >= 4 && !team.members.includes(currentUser)) {
                alert('Ø§Ù„ÙØ±ÙŠÙ‚ Ù…Ù…ØªÙ„Ø¦!');
                return;
            }

            if (!team.members.includes(currentUser)) {
                team.members.push(currentUser);
                if (!team.leader) {
                    team.leader = currentUser;
                }
                saveGameState();
            }

            currentTeam = team;
            document.getElementById('startBtn').classList.add('show');
            renderTeams();
        }

        function leaveTeam(teamId) {
            const team = teams.find(t => t.id === teamId);
            team.members = team.members.filter(m => m !== currentUser);

            if (team.leader === currentUser && team.members.length > 0) {
                team.leader = team.members[0];
            } else if (team.members.length === 0) {
                team.leader = null;
            }

            saveGameState();

            if (currentTeam && currentTeam.id === teamId) {
                currentTeam = null;
                document.getElementById('startBtn').classList.remove('show');
            }

            renderTeams();
        }

        function startGame() {
            if (!currentTeam || currentTeam.members.length === 0) {
                alert('Ø§Ø®ØªØ± ÙØ±ÙŠÙ‚Ø§Ù‹');
                return;
            }

            if (!gameStarted) {
                gameStarted = true;
                saveGameState();
                startTimer();
            }

            document.getElementById('teamInfoCode').textContent = `ğŸ¯ Ø§Ù„ÙØ±ÙŠÙ‚: ${currentTeam.number} | Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡: ${currentTeam.members.join(', ')}`;
            showScreen('codeScreen');
            document.getElementById('codeInput').focus();
        }

        function updateTimerDisplay() {
            const hours = Math.floor(timeRemaining / 3600);
            const minutes = Math.floor((timeRemaining % 3600) / 60);
            const seconds = timeRemaining % 60;
            const timeStr = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            
            if (document.getElementById('timeDisplay')) {
                document.getElementById('timeDisplay').textContent = timeStr;
            }
            if (document.getElementById('codeTimer')) {
                document.getElementById('codeTimer').textContent = `â±ï¸ ${timeStr}`;
            }
        }

        function startTimer() {
            document.getElementById('timerDisplay').style.display = 'block';
            document.getElementById('codeTimer').style.display = 'block';

            timerInterval = setInterval(() => {
                timeRemaining--;
                saveGameState();
                updateTimerDisplay();

                if (timeRemaining === 300) {
                    alert('âš ï¸ ØªØ­Ø°ÙŠØ±: 5 Ø¯Ù‚Ø§Ø¦Ù‚ ÙÙ‚Ø· Ù…ØªØ¨Ù‚ÙŠØ©!');
                    if (document.getElementById('timeDisplay')) {
                        document.getElementById('timeDisplay').style.color = '#ff6b6b';
                    }
                    if (document.getElementById('codeTimer')) {
                        document.getElementById('codeTimer').style.color = '#ff6b6b';
                    }
                }

                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    alert('â° Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!');
                    endGame();
                }
            }, 1000);
        }

        function endGame() {
            gameStarted = false;
            clearInterval(timerInterval);
            timeRemaining = 7200;
            backToTeams();
        }

        function verifyCode() {
            const input = document.getElementById('codeInput').value.trim().toUpperCase();
            const correctCode = CODES[currentTeam.codeIndex];
            const msg = document.getElementById('codeMessage');

            if (input === correctCode) {
                msg.textContent = 'âœ… ØµØ­ÙŠØ­! ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ù„ÙØ§Øª';
                msg.className = 'message success';
                currentTeam.solved = true;
                
                // Ø®ØµÙ… 15 Ø¯Ù‚ÙŠÙ‚Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ø¬Ø§Ø­
                timeRemaining = Math.max(0, timeRemaining - 900);
                saveGameState();

                setTimeout(() => {
                    showImages();
                }, 1500);
            } else {
                currentTeam.attempts++;
                msg.innerHTML = `âŒ Ø®Ø·Ø£! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰<br>Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: ${currentTeam.attempts}`;
                msg.className = 'message error';
                document.getElementById('codeInput').value = '';
                document.getElementById('codeInput').focus();
                saveGameState();
            }
        }

        function showImages() {
            const grid = document.getElementById('imagesGrid');
            grid.innerHTML = '';

            IMAGES.forEach((imageUrl, index) => {
                const imageBox = document.createElement('div');
                imageBox.className = 'image-box';
                const img = document.createElement('img');
                img.src = imageUrl;
                img.alt = `ØµÙˆØ±Ø© ${index + 1}`;
                img.style.width = '100%';
                img.style.height = '100%';
                img.style.objectFit = 'cover';
                img.onerror = function() {
                    this.src = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 400"><rect fill="%23333" width="300" height="400"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="%23999" font-size="20">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„</text></svg>';
                };
                imageBox.appendChild(img);
                grid.appendChild(imageBox);
            });

            showScreen('imagesScreen');
        }

        function backToTeams() {
            document.getElementById('codeInput').value = '';
            document.getElementById('codeMessage').textContent = '';
            showScreen('teamsScreen');
        }

        function backToLogin() {
            currentUser = null;
            currentTeam = null;
            document.getElementById('userNameInput').value = '';
            document.getElementById('adminPassInput').value = '';
            showScreen('loginScreen');
        }

        function showStats() {
            const stats = teams.map(t => ({
                teamNumber: t.number,
                members: t.members.length,
                solved: t.solved ? 'âœ…' : 'âŒ',
                attempts: t.attempts
            }));

            let html = '<h3 style="color: #d4af37; margin-top: 30px;">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:</h3>';
            html += '<table class="stats-table"><tr><th>Ø§Ù„ÙØ±ÙŠÙ‚</th><th>Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</th><th>Ù…ÙƒØªÙ…Ù„</th><th>Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª</th></tr>';

            stats.forEach(s => {
                html += `<tr><td>Ø§Ù„ÙØ±ÙŠÙ‚ ${s.teamNumber}</td><td>${s.members}</td><td>${s.solved}</td><td>${s.attempts}</td></tr>`;
            });

            html += '</table>';
            document.getElementById('statsContainer').innerHTML = html;
        }

        function resetGame() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„Ø¹Ø¨Ø©ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!')) {
                localStorage.clear();
                teams.forEach(t => {
                    t.members = [];
                    t.leader = null;
                    t.solved = false;
                    t.attempts = 0;
                });
                gameStarted = false;
                timeRemaining = 7200;
                gameData = {
                    started: false,
                    timeRemaining: 7200,
                    teams: []
                };
                initializeGameData();
                alert('âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„Ø¹Ø¨Ø©');
                backToLogin();
            }
        }

        loadGameState();
    </script>
</body>
</html>
